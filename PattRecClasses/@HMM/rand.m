function [X,S]=rand(h,nSamples)%[X,S]=rand(h,nSamples);generates a random sequence of data%from a given Hidden Markov Model.%%Input:%h=         HMM object%nSamples=  maximum no of output samples (scalars or column vectors)%%Result:%X= matrix or row vector with output data samples%S= row vector with corresponding integer state values%   obtained from the h.StateGen component.%   nS= length(S) == size(X,2)= number of output samples.%   If the StateGen can generate infinite-duration sequences,%       nS == nSamples%   If the StateGen is a finite-duration MarkovChain,%       nS <= nSamples%%----------------------------------------------------%Code Authors:Varsha Kirani, Vamshi Krishna%----------------------------------------------------if numel(h)>1    error('Method works only for a single object');end;StateSequence = genRandStateSequence(h.StateGen,nSamples); %generates randomn state sequence% for discreteD and single variate gaussD objects if length(h.OutputDistr(StateSequence(1)).Mean == 1)    outputValues = zeros(length(StateSequence),1);end% for multivariate GaussD objectsif length(h.OutputDistr(StateSequence(1)).Mean > 1)    outputValues = zeros(length(StateSequence),length(h.OutputDistr(StateSequence(1)).Mean));endfor i=1:length(StateSequence)    stateDistr = h.OutputDistr(StateSequence(i));      if isa(stateDistr,'DiscreteD')        outputValues(i) = rand(h.OutputDistr(StateSequence(i)),1);    end        if isa(stateDistr,'GaussD')        %multivariate -Mean Vector and Covariance matrix or Variance vector        if length(stateDistr.Mean) > 1            outputValues(i,:)=mvnrnd(stateDistr.Mean,stateDistr.Covariance);        end        %single variate - scalar mean and variance        if length(stateDistr.Mean) == 1            outputValues(i)=normrnd(stateDistr.Mean,stateDistr.StDev);        end            end     endS= StateSequence;X=outputValues;end